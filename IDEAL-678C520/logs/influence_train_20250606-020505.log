🚀 开始训练...
🖥️  使用GPU: 0,1,2,3
📄 配置文件: 
📅 开始时间: 2025年 06月 06日 星期五 02:05:05 CST
The following values were not passed to `accelerate launch` and had defaults used instead:
	`--num_processes` was set to a value of `4`
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
We've detected an older driver with an RTX 4000 series GPU. These drivers have issues with P2P. This can affect the multi-gpu inference when using accelerate device_map.Please make sure to update your driver to the latest version which resolves this.
We've detected an older driver with an RTX 4000 series GPU. These drivers have issues with P2P. This can affect the multi-gpu inference when using accelerate device_map.Please make sure to update your driver to the latest version which resolves this.
We've detected an older driver with an RTX 4000 series GPU. These drivers have issues with P2P. This can affect the multi-gpu inference when using accelerate device_map.Please make sure to update your driver to the latest version which resolves this.
We've detected an older driver with an RTX 4000 series GPU. These drivers have issues with P2P. This can affect the multi-gpu inference when using accelerate device_map.Please make sure to update your driver to the latest version which resolves this.
  0%|          | 0/9 [00:00<?, ?it/s]  0%|          | 0/9 [00:00<?, ?it/s]  0%|          | 0/9 [00:00<?, ?it/s]  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:27<03:43, 27.90s/it] 11%|█         | 1/9 [00:29<03:53, 29.14s/it] 11%|█         | 1/9 [00:29<03:58, 29.87s/it] 11%|█         | 1/9 [00:29<03:57, 29.70s/it] 22%|██▏       | 2/9 [00:55<03:13, 27.67s/it] 22%|██▏       | 2/9 [00:57<03:20, 28.63s/it] 22%|██▏       | 2/9 [00:57<03:20, 28.63s/it] 22%|██▏       | 2/9 [00:58<03:24, 29.27s/it] 33%|███▎      | 3/9 [01:23<02:46, 27.67s/it] 33%|███▎      | 3/9 [01:25<02:49, 28.17s/it] 33%|███▎      | 3/9 [01:25<02:50, 28.47s/it] 33%|███▎      | 3/9 [01:26<02:52, 28.75s/it] 44%|████▍     | 4/9 [01:50<02:17, 27.59s/it] 44%|████▍     | 4/9 [01:52<02:20, 28.00s/it] 44%|████▍     | 4/9 [01:53<02:20, 28.09s/it] 44%|████▍     | 4/9 [01:54<02:21, 28.36s/it] 56%|█████▌    | 5/9 [02:18<01:50, 27.74s/it] 56%|█████▌    | 5/9 [02:21<01:52, 28.15s/it] 56%|█████▌    | 5/9 [02:23<01:53, 28.39s/it] 56%|█████▌    | 5/9 [02:22<01:54, 28.59s/it] 67%|██████▋   | 6/9 [02:46<01:23, 27.98s/it] 67%|██████▋   | 6/9 [02:49<01:24, 28.24s/it] 67%|██████▋   | 6/9 [02:52<01:25, 28.65s/it] 67%|██████▋   | 6/9 [02:52<01:26, 28.91s/it] 78%|███████▊  | 7/9 [03:15<00:56, 28.15s/it] 78%|███████▊  | 7/9 [03:18<00:56, 28.46s/it] 78%|███████▊  | 7/9 [03:20<00:57, 28.52s/it] 78%|███████▊  | 7/9 [03:22<00:58, 29.32s/it] 89%|████████▉ | 8/9 [03:44<00:28, 28.48s/it] 89%|████████▉ | 8/9 [03:46<00:28, 28.42s/it] 89%|████████▉ | 8/9 [03:49<00:28, 28.75s/it] 89%|████████▉ | 8/9 [03:51<00:29, 29.36s/it]100%|██████████| 9/9 [04:12<00:00, 28.35s/it]100%|██████████| 9/9 [04:12<00:00, 28.08s/it]
  0%|          | 0/72 [00:00<?, ?it/s]100%|██████████| 9/9 [04:14<00:00, 28.22s/it]100%|██████████| 9/9 [04:14<00:00, 28.29s/it]
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:00<00:34,  2.07it/s]  3%|▎         | 2/72 [00:00<00:18,  3.75it/s]  1%|▏         | 1/72 [00:02<02:52,  2.43s/it]  4%|▍         | 3/72 [00:00<00:13,  5.17it/s]  3%|▎         | 2/72 [00:02<01:16,  1.09s/it]  6%|▌         | 4/72 [00:01<00:18,  3.59it/s]  7%|▋         | 5/72 [00:01<00:14,  4.63it/s]  8%|▊         | 6/72 [00:01<00:11,  5.61it/s]  4%|▍         | 3/72 [00:03<01:03,  1.09it/s] 10%|▉         | 7/72 [00:01<00:15,  4.10it/s] 11%|█         | 8/72 [00:01<00:12,  5.02it/s] 12%|█▎        | 9/72 [00:01<00:10,  5.91it/s] 14%|█▍        | 10/72 [00:02<00:15,  4.11it/s] 15%|█▌        | 11/72 [00:02<00:12,  4.95it/s] 17%|█▋        | 12/72 [00:02<00:10,  5.78it/s] 18%|█▊        | 13/72 [00:02<00:14,  4.01it/s] 19%|█▉        | 14/72 [00:03<00:11,  4.86it/s] 21%|██        | 15/72 [00:03<00:09,  5.71it/s]  6%|▌         | 4/72 [00:05<01:23,  1.23s/it]100%|██████████| 9/9 [04:17<00:00, 28.57s/it]100%|██████████| 9/9 [04:17<00:00, 28.65s/it]
Calculating Q List!
Entering Getting Q Lists
  0%|          | 0/72 [00:00<?, ?it/s] 22%|██▏       | 16/72 [00:03<00:14,  3.78it/s] 24%|██▎       | 17/72 [00:03<00:11,  4.63it/s]  1%|▏         | 1/72 [00:00<00:32,  2.16it/s] 25%|██▌       | 18/72 [00:03<00:09,  5.49it/s]  3%|▎         | 2/72 [00:00<00:19,  3.67it/s]  8%|▊         | 6/72 [00:05<00:52,  1.26it/s]  4%|▍         | 3/72 [00:00<00:13,  5.08it/s] 26%|██▋       | 19/72 [00:04<00:14,  3.66it/s] 28%|██▊       | 20/72 [00:04<00:11,  4.49it/s]  6%|▌         | 4/72 [00:01<00:19,  3.43it/s] 29%|██▉       | 21/72 [00:04<00:09,  5.36it/s]  7%|▋         | 5/72 [00:01<00:14,  4.47it/s]  8%|▊         | 6/72 [00:01<00:12,  5.48it/s] 31%|███       | 22/72 [00:04<00:12,  4.03it/s] 32%|███▏      | 23/72 [00:05<00:10,  4.86it/s] 10%|▉         | 7/72 [00:01<00:14,  4.38it/s]100%|██████████| 9/9 [04:19<00:00, 28.77s/it]100%|██████████| 9/9 [04:19<00:00, 28.83s/it]
 33%|███▎      | 24/72 [00:05<00:08,  5.71it/s] 11%|█         | 8/72 [00:01<00:12,  5.32it/s]  0%|          | 0/72 [00:00<?, ?it/s] 12%|█▎        | 9/72 [00:01<00:10,  6.15it/s] 35%|███▍      | 25/72 [00:05<00:11,  3.98it/s]  1%|▏         | 1/72 [00:00<00:27,  2.54it/s] 14%|█▍        | 10/72 [00:02<00:14,  4.38it/s] 10%|▉         | 7/72 [00:07<01:06,  1.02s/it] 36%|███▌      | 26/72 [00:05<00:09,  4.83it/s]  3%|▎         | 2/72 [00:00<00:15,  4.53it/s] 15%|█▌        | 11/72 [00:02<00:11,  5.28it/s] 38%|███▊      | 27/72 [00:05<00:07,  5.68it/s] 11%|█         | 8/72 [00:07<00:49,  1.30it/s] 17%|█▋        | 12/72 [00:02<00:09,  6.13it/s]  6%|▌         | 4/72 [00:00<00:16,  4.17it/s] 39%|███▉      | 28/72 [00:06<00:11,  3.89it/s] 18%|█▊        | 13/72 [00:02<00:14,  4.13it/s] 40%|████      | 29/72 [00:06<00:09,  4.74it/s] 19%|█▉        | 14/72 [00:02<00:11,  5.01it/s]  8%|▊         | 6/72 [00:01<00:11,  5.78it/s] 42%|████▏     | 30/72 [00:06<00:07,  5.60it/s] 21%|██        | 15/72 [00:03<00:09,  5.87it/s] 12%|█▎        | 9/72 [00:08<00:47,  1.33it/s] 10%|▉         | 7/72 [00:01<00:13,  4.78it/s] 43%|████▎     | 31/72 [00:06<00:10,  3.98it/s] 22%|██▏       | 16/72 [00:03<00:13,  4.23it/s] 12%|█▎        | 9/72 [00:01<00:10,  6.19it/s] 44%|████▍     | 32/72 [00:06<00:08,  4.83it/s] 24%|██▎       | 17/72 [00:03<00:10,  5.11it/s] 46%|████▌     | 33/72 [00:07<00:06,  5.69it/s] 14%|█▍        | 10/72 [00:02<00:12,  4.90it/s] 17%|█▋        | 12/72 [00:02<00:09,  6.01it/s] 26%|██▋       | 19/72 [00:04<00:12,  4.32it/s] 47%|████▋     | 34/72 [00:07<00:10,  3.79it/s] 49%|████▊     | 35/72 [00:07<00:08,  4.62it/s] 29%|██▉       | 21/72 [00:04<00:09,  5.59it/s] 50%|█████     | 36/72 [00:07<00:06,  5.46it/s] 18%|█▊        | 13/72 [00:02<00:12,  4.64it/s] 21%|██        | 15/72 [00:02<00:09,  5.87it/s] 31%|███       | 22/72 [00:04<00:11,  4.31it/s] 14%|█▍        | 10/72 [00:09<01:02,  1.01s/it] 51%|█████▏    | 37/72 [00:08<00:08,  3.90it/s] 15%|█▌        | 11/72 [00:10<00:45,  1.35it/s] 53%|█████▎    | 38/72 [00:08<00:07,  4.74it/s] 33%|███▎      | 24/72 [00:04<00:08,  5.54it/s] 54%|█████▍    | 39/72 [00:08<00:05,  5.58it/s] 22%|██▏       | 16/72 [00:03<00:11,  4.77it/s] 25%|██▌       | 18/72 [00:03<00:08,  6.03it/s] 35%|███▍      | 25/72 [00:05<00:10,  4.34it/s] 56%|█████▌    | 40/72 [00:08<00:08,  3.98it/s] 57%|█████▋    | 41/72 [00:08<00:06,  4.83it/s] 38%|███▊      | 27/72 [00:05<00:08,  5.55it/s] 17%|█▋        | 12/72 [00:10<00:43,  1.37it/s] 26%|██▋       | 19/72 [00:03<00:10,  4.82it/s] 58%|█████▊    | 42/72 [00:09<00:05,  5.70it/s] 29%|██▉       | 21/72 [00:03<00:08,  6.09it/s] 39%|███▉      | 28/72 [00:05<00:10,  4.36it/s] 60%|█████▉    | 43/72 [00:09<00:07,  4.00it/s] 31%|███       | 22/72 [00:04<00:10,  4.80it/s] 61%|██████    | 44/72 [00:09<00:05,  4.84it/s] 42%|████▏     | 30/72 [00:06<00:07,  5.55it/s] 62%|██████▎   | 45/72 [00:09<00:04,  5.70it/s] 33%|███▎      | 24/72 [00:04<00:07,  6.05it/s] 43%|████▎     | 31/72 [00:06<00:09,  4.31it/s] 64%|██████▍   | 46/72 [00:10<00:06,  3.94it/s] 35%|███▍      | 25/72 [00:04<00:09,  4.80it/s] 46%|████▌     | 33/72 [00:06<00:07,  5.50it/s] 65%|██████▌   | 47/72 [00:10<00:05,  4.76it/s] 38%|███▊      | 27/72 [00:05<00:07,  6.06it/s] 67%|██████▋   | 48/72 [00:10<00:04,  5.59it/s] 47%|████▋     | 34/72 [00:07<00:08,  4.39it/s] 18%|█▊        | 13/72 [00:12<00:59,  1.00s/it] 39%|███▉      | 28/72 [00:05<00:09,  4.74it/s] 49%|████▊     | 35/72 [00:07<00:07,  5.05it/s] 19%|█▉        | 14/72 [00:12<00:42,  1.36it/s] 68%|██████▊   | 49/72 [00:10<00:05,  3.98it/s] 69%|██████▉   | 50/72 [00:10<00:04,  4.83it/s] 42%|████▏     | 30/72 [00:05<00:07,  5.98it/s] 71%|███████   | 51/72 [00:10<00:03,  5.69it/s] 51%|█████▏    | 37/72 [00:07<00:07,  4.61it/s] 43%|████▎     | 31/72 [00:05<00:08,  4.80it/s] 53%|█████▎    | 38/72 [00:07<00:06,  5.24it/s] 72%|███████▏  | 52/72 [00:11<00:05,  3.94it/s] 21%|██        | 15/72 [00:13<00:41,  1.38it/s] 46%|████▌     | 33/72 [00:06<00:06,  6.00it/s] 74%|███████▎  | 53/72 [00:11<00:03,  4.77it/s] 75%|███████▌  | 54/72 [00:11<00:03,  5.62it/s] 56%|█████▌    | 40/72 [00:08<00:06,  4.83it/s] 47%|████▋     | 34/72 [00:06<00:07,  4.82it/s] 57%|█████▋    | 41/72 [00:08<00:05,  5.43it/s] 58%|█████▊    | 42/72 [00:08<00:04,  6.05it/s] 50%|█████     | 36/72 [00:06<00:05,  6.06it/s] 76%|███████▋  | 55/72 [00:11<00:04,  4.00it/s] 78%|███████▊  | 56/72 [00:12<00:03,  4.85it/s] 79%|███████▉  | 57/72 [00:12<00:02,  5.71it/s] 60%|█████▉    | 43/72 [00:08<00:06,  4.66it/s] 51%|█████▏    | 37/72 [00:07<00:07,  4.91it/s] 61%|██████    | 44/72 [00:09<00:05,  5.42it/s] 54%|█████▍    | 39/72 [00:07<00:05,  6.17it/s] 62%|██████▎   | 45/72 [00:09<00:04,  6.17it/s] 81%|████████  | 58/72 [00:12<00:03,  3.84it/s] 82%|████████▏ | 59/72 [00:12<00:02,  4.67it/s] 56%|█████▌    | 40/72 [00:07<00:06,  4.94it/s] 83%|████████▎ | 60/72 [00:12<00:02,  5.54it/s] 64%|██████▍   | 46/72 [00:09<00:05,  4.58it/s] 65%|██████▌   | 47/72 [00:09<00:04,  5.36it/s] 58%|█████▊    | 42/72 [00:07<00:04,  6.18it/s] 67%|██████▋   | 48/72 [00:09<00:03,  6.14it/s] 22%|██▏       | 16/72 [00:14<00:56,  1.01s/it] 24%|██▎       | 17/72 [00:14<00:40,  1.35it/s] 85%|████████▍ | 61/72 [00:13<00:02,  4.32it/s] 86%|████████▌ | 62/72 [00:13<00:01,  5.19it/s] 60%|█████▉    | 43/72 [00:08<00:06,  4.83it/s] 88%|████████▊ | 63/72 [00:13<00:01,  6.02it/s] 68%|██████▊   | 49/72 [00:10<00:05,  4.52it/s] 69%|██████▉   | 50/72 [00:10<00:04,  5.33it/s] 62%|██████▎   | 45/72 [00:08<00:04,  6.06it/s] 71%|███████   | 51/72 [00:10<00:03,  6.11it/s] 89%|████████▉ | 64/72 [00:13<00:01,  4.39it/s] 90%|█████████ | 65/72 [00:13<00:01,  5.25it/s] 25%|██▌       | 18/72 [00:15<00:39,  1.37it/s] 64%|██████▍   | 46/72 [00:08<00:05,  4.88it/s] 92%|█████████▏| 66/72 [00:13<00:00,  6.10it/s] 72%|███████▏  | 52/72 [00:10<00:04,  4.46it/s] 74%|███████▎  | 53/72 [00:10<00:03,  5.28it/s] 67%|██████▋   | 48/72 [00:08<00:03,  6.10it/s] 75%|███████▌  | 54/72 [00:10<00:02,  6.08it/s] 93%|█████████▎| 67/72 [00:14<00:01,  4.07it/s] 68%|██████▊   | 49/72 [00:09<00:04,  4.95it/s] 94%|█████████▍| 68/72 [00:14<00:00,  4.90it/s] 76%|███████▋  | 55/72 [00:11<00:03,  4.48it/s] 96%|█████████▌| 69/72 [00:14<00:00,  5.76it/s] 71%|███████   | 51/72 [00:09<00:03,  6.20it/s] 78%|███████▊  | 56/72 [00:11<00:02,  5.34it/s] 79%|███████▉  | 57/72 [00:11<00:02,  6.19it/s] 72%|███████▏  | 52/72 [00:09<00:04,  4.71it/s] 97%|█████████▋| 70/72 [00:15<00:00,  3.91it/s] 81%|████████  | 58/72 [00:11<00:03,  4.38it/s] 99%|█████████▊| 71/72 [00:15<00:00,  4.73it/s] 75%|███████▌  | 54/72 [00:10<00:03,  5.94it/s] 82%|████████▏ | 59/72 [00:11<00:02,  5.23it/s]100%|██████████| 72/72 [00:15<00:00,  5.61it/s]100%|██████████| 72/72 [00:15<00:00,  4.71it/s]
 83%|████████▎ | 60/72 [00:11<00:01,  6.09it/s] 26%|██▋       | 19/72 [00:17<00:52,  1.00it/s] 76%|███████▋  | 55/72 [00:10<00:03,  4.88it/s] 28%|██▊       | 20/72 [00:17<00:37,  1.37it/s] 85%|████████▍ | 61/72 [00:12<00:02,  4.79it/s] 86%|████████▌ | 62/72 [00:12<00:01,  5.66it/s] 79%|███████▉  | 57/72 [00:10<00:02,  6.12it/s] 88%|████████▊ | 63/72 [00:12<00:01,  6.49it/s] 81%|████████  | 58/72 [00:10<00:02,  4.82it/s] 89%|████████▉ | 64/72 [00:12<00:01,  5.00it/s] 90%|█████████ | 65/72 [00:12<00:01,  5.87it/s] 29%|██▉       | 21/72 [00:18<00:36,  1.39it/s] 83%|████████▎ | 60/72 [00:11<00:01,  6.07it/s] 92%|█████████▏| 66/72 [00:13<00:00,  6.69it/s] 85%|████████▍ | 61/72 [00:11<00:02,  5.03it/s] 93%|█████████▎| 67/72 [00:13<00:01,  4.75it/s] 94%|█████████▍| 68/72 [00:13<00:00,  5.62it/s] 88%|████████▊ | 63/72 [00:11<00:01,  6.28it/s] 89%|████████▉ | 64/72 [00:11<00:01,  5.13it/s] 97%|█████████▋| 70/72 [00:13<00:00,  5.09it/s] 92%|█████████▏| 66/72 [00:12<00:00,  6.37it/s] 99%|█████████▊| 71/72 [00:14<00:00,  5.76it/s]100%|██████████| 72/72 [00:14<00:00,  6.48it/s]100%|██████████| 72/72 [00:14<00:00,  5.10it/s]
 93%|█████████▎| 67/72 [00:12<00:01,  4.93it/s] 96%|█████████▌| 69/72 [00:12<00:00,  6.17it/s] 31%|███       | 22/72 [00:19<00:50,  1.01s/it] 32%|███▏      | 23/72 [00:19<00:36,  1.36it/s] 97%|█████████▋| 70/72 [00:13<00:00,  4.91it/s]100%|██████████| 72/72 [00:13<00:00,  6.19it/s]100%|██████████| 72/72 [00:13<00:00,  5.43it/s]
 33%|███▎      | 24/72 [00:20<00:34,  1.38it/s] 35%|███▍      | 25/72 [00:22<00:46,  1.01it/s] 36%|███▌      | 26/72 [00:22<00:33,  1.38it/s] 38%|███▊      | 27/72 [00:22<00:32,  1.39it/s] 39%|███▉      | 28/72 [00:24<00:43,  1.00it/s] 40%|████      | 29/72 [00:24<00:31,  1.37it/s] 42%|████▏     | 30/72 [00:25<00:30,  1.39it/s] 43%|████▎     | 31/72 [00:27<00:40,  1.01it/s] 44%|████▍     | 32/72 [00:27<00:28,  1.38it/s] 46%|████▌     | 33/72 [00:27<00:27,  1.40it/s] 47%|████▋     | 34/72 [00:29<00:37,  1.01it/s] 49%|████▊     | 35/72 [00:29<00:26,  1.38it/s] 50%|█████     | 36/72 [00:30<00:25,  1.39it/s] 51%|█████▏    | 37/72 [00:31<00:35,  1.00s/it] 53%|█████▎    | 38/72 [00:32<00:24,  1.36it/s] 54%|█████▍    | 39/72 [00:32<00:23,  1.38it/s] 56%|█████▌    | 40/72 [00:34<00:31,  1.00it/s] 57%|█████▋    | 41/72 [00:34<00:22,  1.37it/s] 58%|█████▊    | 42/72 [00:35<00:21,  1.39it/s] 60%|█████▉    | 43/72 [00:36<00:28,  1.00it/s] 61%|██████    | 44/72 [00:36<00:20,  1.37it/s] 62%|██████▎   | 45/72 [00:37<00:19,  1.40it/s] 64%|██████▍   | 46/72 [00:39<00:26,  1.00s/it] 65%|██████▌   | 47/72 [00:39<00:18,  1.36it/s] 67%|██████▋   | 48/72 [00:40<00:17,  1.38it/s] 68%|██████▊   | 49/72 [00:41<00:23,  1.00s/it] 69%|██████▉   | 50/72 [00:41<00:16,  1.36it/s] 71%|███████   | 51/72 [00:42<00:15,  1.38it/s] 72%|███████▏  | 52/72 [00:44<00:20,  1.00s/it] 74%|███████▎  | 53/72 [00:44<00:13,  1.37it/s] 75%|███████▌  | 54/72 [00:45<00:12,  1.39it/s] 76%|███████▋  | 55/72 [00:46<00:16,  1.01it/s] 78%|███████▊  | 56/72 [00:46<00:11,  1.38it/s] 81%|████████  | 58/72 [00:49<00:13,  1.06it/s] 82%|████████▏ | 59/72 [00:49<00:09,  1.36it/s] 83%|████████▎ | 60/72 [00:49<00:08,  1.37it/s] 85%|████████▍ | 61/72 [00:51<00:10,  1.03it/s] 86%|████████▌ | 62/72 [00:51<00:07,  1.38it/s] 88%|████████▊ | 63/72 [00:52<00:06,  1.39it/s] 89%|████████▉ | 64/72 [00:53<00:07,  1.03it/s] 90%|█████████ | 65/72 [00:54<00:05,  1.39it/s] 92%|█████████▏| 66/72 [00:54<00:04,  1.40it/s] 93%|█████████▎| 67/72 [00:56<00:05,  1.00s/it] 94%|█████████▍| 68/72 [00:56<00:02,  1.36it/s] 96%|█████████▌| 69/72 [00:57<00:02,  1.38it/s] 97%|█████████▋| 70/72 [00:58<00:01,  1.01it/s] 99%|█████████▊| 71/72 [00:59<00:00,  1.38it/s]100%|██████████| 72/72 [00:59<00:00,  1.39it/s]100%|██████████| 72/72 [00:59<00:00,  1.21it/s]
[rank2]:[W606 02:10:33.455929947 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank3]:[W606 02:10:33.455948543 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank0]:[W606 02:10:33.455963082 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank1]:[W606 02:10:33.456128627 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
  0%|          | 0/72 [00:00<?, ?it/s]  0%|          | 0/72 [00:00<?, ?it/s]  0%|          | 0/72 [00:00<?, ?it/s]  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:00<00:08,  8.63it/s]  1%|▏         | 1/72 [00:00<00:09,  7.59it/s]  1%|▏         | 1/72 [00:00<00:09,  7.51it/s]  3%|▎         | 2/72 [00:00<00:21,  3.19it/s]  3%|▎         | 2/72 [00:00<00:22,  3.10it/s]  3%|▎         | 2/72 [00:00<00:22,  3.15it/s]  1%|▏         | 1/72 [00:00<00:49,  1.43it/s]  4%|▍         | 3/72 [00:00<00:23,  2.92it/s]  4%|▍         | 3/72 [00:00<00:23,  2.92it/s]  4%|▍         | 3/72 [00:01<00:25,  2.70it/s]  3%|▎         | 2/72 [00:01<00:34,  2.02it/s]  6%|▌         | 4/72 [00:01<00:16,  4.03it/s]  6%|▌         | 4/72 [00:01<00:18,  3.71it/s]  7%|▋         | 5/72 [00:01<00:18,  3.70it/s]  7%|▋         | 5/72 [00:01<00:18,  3.56it/s]  7%|▋         | 5/72 [00:01<00:20,  3.24it/s]  8%|▊         | 6/72 [00:01<00:19,  3.42it/s]  8%|▊         | 6/72 [00:01<00:20,  3.29it/s] 10%|▉         | 7/72 [00:01<00:15,  4.19it/s]  8%|▊         | 6/72 [00:01<00:23,  2.86it/s] 10%|▉         | 7/72 [00:02<00:17,  3.70it/s] 11%|█         | 8/72 [00:02<00:16,  3.86it/s] 11%|█         | 8/72 [00:02<00:17,  3.62it/s] 11%|█         | 8/72 [00:02<00:19,  3.21it/s] 12%|█▎        | 9/72 [00:02<00:17,  3.57it/s] 12%|█▎        | 9/72 [00:02<00:19,  3.31it/s] 14%|█▍        | 10/72 [00:02<00:14,  4.17it/s] 12%|█▎        | 9/72 [00:02<00:22,  2.84it/s] 15%|█▌        | 11/72 [00:02<00:15,  3.93it/s] 14%|█▍        | 10/72 [00:02<00:17,  3.61it/s] 15%|█▌        | 11/72 [00:03<00:16,  3.66it/s] 17%|█▋        | 12/72 [00:03<00:16,  3.59it/s] 18%|█▊        | 13/72 [00:03<00:14,  4.04it/s] 17%|█▋        | 12/72 [00:03<00:19,  3.08it/s] 15%|█▌        | 11/72 [00:03<00:21,  2.87it/s]  4%|▍         | 3/72 [00:03<01:38,  1.42s/it] 18%|█▊        | 13/72 [00:03<00:15,  3.88it/s]  6%|▌         | 4/72 [00:03<01:01,  1.10it/s] 19%|█▉        | 14/72 [00:03<00:16,  3.53it/s] 17%|█▋        | 12/72 [00:03<00:22,  2.63it/s] 19%|█▉        | 14/72 [00:03<00:16,  3.42it/s] 18%|█▊        | 13/72 [00:04<00:17,  3.37it/s] 21%|██        | 15/72 [00:04<00:17,  3.30it/s] 21%|██        | 15/72 [00:04<00:17,  3.23it/s] 19%|█▉        | 14/72 [00:04<00:18,  3.15it/s] 24%|██▎       | 17/72 [00:04<00:14,  3.73it/s] 24%|██▎       | 17/72 [00:04<00:15,  3.62it/s] 21%|██        | 15/72 [00:04<00:19,  2.85it/s] 22%|██▏       | 16/72 [00:04<00:15,  3.61it/s] 25%|██▌       | 18/72 [00:05<00:15,  3.46it/s] 25%|██▌       | 18/72 [00:05<00:15,  3.40it/s] 24%|██▎       | 17/72 [00:05<00:16,  3.25it/s] 28%|██▊       | 20/72 [00:05<00:13,  3.81it/s] 28%|██▊       | 20/72 [00:05<00:13,  3.76it/s] 25%|██▌       | 18/72 [00:05<00:18,  2.88it/s] 29%|██▉       | 21/72 [00:05<00:14,  3.55it/s] 26%|██▋       | 19/72 [00:05<00:14,  3.62it/s] 31%|███       | 22/72 [00:05<00:11,  4.17it/s] 29%|██▉       | 21/72 [00:05<00:14,  3.44it/s]  7%|▋         | 5/72 [00:06<01:34,  1.41s/it] 31%|███       | 22/72 [00:06<00:12,  4.10it/s] 32%|███▏      | 23/72 [00:06<00:14,  3.40it/s] 28%|██▊       | 20/72 [00:06<00:17,  2.98it/s] 32%|███▏      | 23/72 [00:06<00:14,  3.31it/s] 33%|███▎      | 24/72 [00:06<00:15,  3.16it/s] 29%|██▉       | 21/72 [00:06<00:18,  2.75it/s] 33%|███▎      | 24/72 [00:06<00:15,  3.15it/s] 31%|███       | 22/72 [00:06<00:14,  3.48it/s] 35%|███▍      | 25/72 [00:06<00:12,  3.88it/s] 36%|███▌      | 26/72 [00:07<00:12,  3.62it/s] 32%|███▏      | 23/72 [00:07<00:16,  3.05it/s] 36%|███▌      | 26/72 [00:07<00:13,  3.53it/s] 38%|███▊      | 27/72 [00:07<00:13,  3.39it/s] 38%|███▊      | 27/72 [00:07<00:14,  3.20it/s] 33%|███▎      | 24/72 [00:07<00:17,  2.77it/s] 35%|███▍      | 25/72 [00:07<00:13,  3.51it/s] 40%|████      | 29/72 [00:07<00:11,  3.76it/s] 40%|████      | 29/72 [00:08<00:12,  3.54it/s] 36%|███▌      | 26/72 [00:08<00:15,  3.02it/s] 42%|████▏     | 30/72 [00:08<00:11,  3.52it/s] 43%|████▎     | 31/72 [00:08<00:09,  4.17it/s]  8%|▊         | 6/72 [00:08<01:57,  1.78s/it] 42%|████▏     | 30/72 [00:08<00:12,  3.23it/s] 10%|▉         | 7/72 [00:08<01:20,  1.23s/it] 43%|████▎     | 31/72 [00:08<00:10,  3.83it/s] 38%|███▊      | 27/72 [00:08<00:16,  2.76it/s] 44%|████▍     | 32/72 [00:08<00:10,  3.73it/s] 39%|███▉      | 28/72 [00:08<00:12,  3.44it/s] 44%|████▍     | 32/72 [00:09<00:11,  3.41it/s] 46%|████▌     | 33/72 [00:09<00:11,  3.42it/s] 40%|████      | 29/72 [00:09<00:13,  3.16it/s] 46%|████▌     | 33/72 [00:09<00:12,  3.20it/s] 47%|████▋     | 34/72 [00:09<00:09,  3.96it/s] 49%|████▊     | 35/72 [00:09<00:09,  3.70it/s] 42%|████▏     | 30/72 [00:09<00:14,  2.83it/s] 43%|████▎     | 31/72 [00:09<00:11,  3.58it/s] 49%|████▊     | 35/72 [00:09<00:10,  3.42it/s] 50%|█████     | 36/72 [00:09<00:10,  3.43it/s] 44%|████▍     | 32/72 [00:10<00:13,  3.07it/s] 50%|█████     | 36/72 [00:10<00:11,  3.11it/s] 51%|█████▏    | 37/72 [00:10<00:08,  3.90it/s] 53%|█████▎    | 38/72 [00:10<00:09,  3.64it/s] 46%|████▌     | 33/72 [00:10<00:14,  2.78it/s] 47%|████▋     | 34/72 [00:10<00:10,  3.51it/s] 53%|█████▎    | 38/72 [00:10<00:09,  3.45it/s] 54%|█████▍    | 39/72 [00:10<00:09,  3.37it/s] 11%|█         | 8/72 [00:11<01:44,  1.63s/it] 54%|█████▍    | 39/72 [00:11<00:11,  2.94it/s] 49%|████▊     | 35/72 [00:11<00:13,  2.80it/s] 57%|█████▋    | 41/72 [00:11<00:08,  3.56it/s] 56%|█████▌    | 40/72 [00:11<00:08,  3.70it/s] 50%|█████     | 36/72 [00:11<00:13,  2.77it/s] 58%|█████▊    | 42/72 [00:11<00:08,  3.37it/s] 57%|█████▋    | 41/72 [00:11<00:09,  3.39it/s] 51%|█████▏    | 37/72 [00:11<00:09,  3.51it/s] 60%|█████▉    | 43/72 [00:11<00:07,  4.00it/s] 58%|█████▊    | 42/72 [00:12<00:09,  3.12it/s] 61%|██████    | 44/72 [00:12<00:08,  3.42it/s] 60%|█████▉    | 43/72 [00:12<00:07,  3.92it/s] 53%|█████▎    | 38/72 [00:12<00:11,  2.91it/s] 61%|██████    | 44/72 [00:12<00:08,  3.46it/s] 62%|██████▎   | 45/72 [00:12<00:08,  3.18it/s] 54%|█████▍    | 39/72 [00:12<00:11,  2.82it/s] 56%|█████▌    | 40/72 [00:12<00:08,  3.58it/s] 62%|██████▎   | 45/72 [00:12<00:08,  3.22it/s] 64%|██████▍   | 46/72 [00:13<00:06,  4.04it/s] 65%|██████▌   | 47/72 [00:13<00:07,  3.55it/s] 57%|█████▋    | 41/72 [00:13<00:10,  3.04it/s] 65%|██████▌   | 47/72 [00:13<00:07,  3.55it/s] 67%|██████▋   | 48/72 [00:13<00:07,  3.31it/s] 68%|██████▊   | 49/72 [00:13<00:05,  3.98it/s] 58%|█████▊    | 42/72 [00:13<00:10,  2.89it/s] 12%|█▎        | 9/72 [00:13<02:00,  1.92s/it] 60%|█████▉    | 43/72 [00:13<00:07,  3.65it/s] 67%|██████▋   | 48/72 [00:13<00:07,  3.25it/s] 14%|█▍        | 10/72 [00:13<01:25,  1.37s/it] 68%|██████▊   | 49/72 [00:13<00:05,  4.06it/s] 69%|██████▉   | 50/72 [00:13<00:06,  3.57it/s] 61%|██████    | 44/72 [00:14<00:09,  3.10it/s] 69%|██████▉   | 50/72 [00:14<00:06,  3.55it/s] 71%|███████   | 51/72 [00:14<00:06,  3.29it/s] 62%|██████▎   | 45/72 [00:14<00:09,  2.95it/s] 64%|██████▍   | 46/72 [00:14<00:06,  3.73it/s] 71%|███████   | 51/72 [00:14<00:06,  3.29it/s] 72%|███████▏  | 52/72 [00:14<00:04,  4.09it/s] 74%|███████▎  | 53/72 [00:14<00:05,  3.72it/s] 65%|██████▌   | 47/72 [00:15<00:07,  3.14it/s] 74%|███████▎  | 53/72 [00:15<00:05,  3.59it/s] 75%|███████▌  | 54/72 [00:15<00:05,  3.44it/s] 75%|███████▌  | 54/72 [00:15<00:05,  3.11it/s] 67%|██████▋   | 48/72 [00:15<00:08,  2.70it/s] 78%|███████▊  | 56/72 [00:15<00:04,  3.68it/s] 76%|███████▋  | 55/72 [00:15<00:04,  3.89it/s] 68%|██████▊   | 49/72 [00:15<00:06,  3.42it/s] 79%|███████▉  | 57/72 [00:15<00:04,  3.38it/s] 78%|███████▊  | 56/72 [00:15<00:04,  3.38it/s] 81%|████████  | 58/72 [00:16<00:03,  4.02it/s] 15%|█▌        | 11/72 [00:16<01:40,  1.65s/it] 69%|██████▉   | 50/72 [00:16<00:07,  2.97it/s] 79%|███████▉  | 57/72 [00:16<00:04,  3.20it/s] 82%|████████▏ | 59/72 [00:16<00:03,  3.55it/s] 81%|████████  | 58/72 [00:16<00:03,  4.00it/s] 71%|███████   | 51/72 [00:16<00:07,  2.71it/s] 72%|███████▏  | 52/72 [00:16<00:05,  3.46it/s] 83%|████████▎ | 60/72 [00:16<00:03,  3.30it/s] 82%|████████▏ | 59/72 [00:16<00:03,  3.52it/s] 85%|████████▍ | 61/72 [00:16<00:02,  4.06it/s] 74%|███████▎  | 53/72 [00:17<00:06,  3.04it/s] 83%|████████▎ | 60/72 [00:17<00:03,  3.30it/s] 85%|████████▍ | 61/72 [00:17<00:02,  4.12it/s] 86%|████████▌ | 62/72 [00:17<00:02,  3.54it/s] 75%|███████▌  | 54/72 [00:17<00:06,  2.76it/s] 76%|███████▋  | 55/72 [00:17<00:04,  3.50it/s] 86%|████████▌ | 62/72 [00:17<00:02,  3.60it/s] 88%|████████▊ | 63/72 [00:17<00:02,  3.25it/s] 89%|████████▉ | 64/72 [00:17<00:01,  4.04it/s] 88%|████████▊ | 63/72 [00:17<00:02,  3.24it/s] 78%|███████▊  | 56/72 [00:18<00:05,  3.01it/s] 89%|████████▉ | 64/72 [00:18<00:01,  4.05it/s] 90%|█████████ | 65/72 [00:18<00:01,  3.53it/s] 90%|█████████ | 65/72 [00:18<00:02,  3.26it/s] 79%|███████▉  | 57/72 [00:18<00:05,  2.54it/s] 92%|█████████▏| 66/72 [00:18<00:02,  2.98it/s] 17%|█▋        | 12/72 [00:18<01:54,  1.91s/it] 81%|████████  | 58/72 [00:18<00:04,  3.25it/s] 18%|█▊        | 13/72 [00:18<01:20,  1.37s/it] 92%|█████████▏| 66/72 [00:18<00:01,  3.14it/s] 93%|█████████▎| 67/72 [00:18<00:01,  3.94it/s] 94%|█████████▍| 68/72 [00:19<00:01,  3.50it/s] 82%|████████▏ | 59/72 [00:19<00:04,  3.03it/s] 94%|█████████▍| 68/72 [00:19<00:01,  3.51it/s] 96%|█████████▌| 69/72 [00:19<00:00,  3.23it/s] 83%|████████▎ | 60/72 [00:19<00:04,  2.92it/s] 85%|████████▍ | 61/72 [00:19<00:02,  3.70it/s] 96%|█████████▌| 69/72 [00:19<00:00,  3.31it/s] 97%|█████████▋| 70/72 [00:19<00:00,  4.13it/s] 99%|█████████▊| 71/72 [00:19<00:00,  3.57it/s] 86%|████████▌ | 62/72 [00:19<00:03,  3.29it/s] 99%|█████████▊| 71/72 [00:20<00:00,  3.70it/s]100%|██████████| 72/72 [00:20<00:00,  3.26it/s]100%|██████████| 72/72 [00:20<00:00,  3.55it/s]
 88%|████████▊ | 63/72 [00:20<00:03,  2.96it/s] 89%|████████▉ | 64/72 [00:20<00:02,  3.73it/s]100%|██████████| 72/72 [00:20<00:00,  3.43it/s]100%|██████████| 72/72 [00:20<00:00,  3.52it/s]
 90%|█████████ | 65/72 [00:20<00:02,  3.12it/s] 19%|█▉        | 14/72 [00:21<01:36,  1.67s/it] 92%|█████████▏| 66/72 [00:21<00:02,  2.91it/s] 93%|█████████▎| 67/72 [00:21<00:01,  3.69it/s] 94%|█████████▍| 68/72 [00:21<00:01,  3.08it/s] 96%|█████████▌| 69/72 [00:22<00:01,  2.80it/s] 97%|█████████▋| 70/72 [00:22<00:00,  3.56it/s] 99%|█████████▊| 71/72 [00:22<00:00,  3.08it/s]100%|██████████| 72/72 [00:23<00:00,  2.77it/s]100%|██████████| 72/72 [00:23<00:00,  3.10it/s]
 21%|██        | 15/72 [00:23<01:49,  1.91s/it] 22%|██▏       | 16/72 [00:23<01:17,  1.38s/it] 24%|██▎       | 17/72 [00:26<01:31,  1.67s/it] 25%|██▌       | 18/72 [00:28<01:42,  1.91s/it] 26%|██▋       | 19/72 [00:28<01:12,  1.36s/it] 28%|██▊       | 20/72 [00:30<01:26,  1.65s/it] 29%|██▉       | 21/72 [00:33<01:36,  1.90s/it] 31%|███       | 22/72 [00:33<01:08,  1.36s/it] 32%|███▏      | 23/72 [00:35<01:21,  1.66s/it] 33%|███▎      | 24/72 [00:38<01:31,  1.90s/it] 35%|███▍      | 25/72 [00:38<01:04,  1.36s/it] 36%|███▌      | 26/72 [00:40<01:16,  1.65s/it] 38%|███▊      | 27/72 [00:43<01:25,  1.90s/it] 39%|███▉      | 28/72 [00:43<00:59,  1.36s/it] 40%|████      | 29/72 [00:45<01:11,  1.67s/it] 42%|████▏     | 30/72 [00:48<01:19,  1.90s/it] 43%|████▎     | 31/72 [00:48<00:55,  1.36s/it] 44%|████▍     | 32/72 [00:50<01:06,  1.66s/it] 46%|████▌     | 33/72 [00:53<01:14,  1.90s/it] 47%|████▋     | 34/72 [00:53<00:51,  1.36s/it] 49%|████▊     | 35/72 [00:55<01:02,  1.68s/it] 50%|█████     | 36/72 [00:58<01:08,  1.91s/it] 51%|█████▏    | 37/72 [00:58<00:47,  1.37s/it] 53%|█████▎    | 38/72 [01:00<00:56,  1.67s/it] 54%|█████▍    | 39/72 [01:03<01:03,  1.92s/it] 56%|█████▌    | 40/72 [01:03<00:43,  1.37s/it] 57%|█████▋    | 41/72 [01:05<00:51,  1.68s/it] 58%|█████▊    | 42/72 [01:07<00:56,  1.90s/it] 60%|█████▉    | 43/72 [01:08<00:39,  1.36s/it] 61%|██████    | 44/72 [01:10<00:46,  1.65s/it] 62%|██████▎   | 45/72 [01:12<00:50,  1.88s/it] 64%|██████▍   | 46/72 [01:12<00:35,  1.35s/it] 65%|██████▌   | 47/72 [01:15<00:41,  1.67s/it] 67%|██████▋   | 48/72 [01:17<00:45,  1.91s/it] 68%|██████▊   | 49/72 [01:17<00:31,  1.37s/it] 69%|██████▉   | 50/72 [01:20<00:36,  1.67s/it] 71%|███████   | 51/72 [01:22<00:40,  1.91s/it] 72%|███████▏  | 52/72 [01:22<00:27,  1.37s/it] 74%|███████▎  | 53/72 [01:25<00:31,  1.66s/it] 75%|███████▌  | 54/72 [01:27<00:34,  1.90s/it] 76%|███████▋  | 55/72 [01:27<00:23,  1.36s/it] 78%|███████▊  | 56/72 [01:30<00:26,  1.67s/it] 79%|███████▉  | 57/72 [01:32<00:28,  1.90s/it] 81%|████████  | 58/72 [01:32<00:19,  1.36s/it] 82%|████████▏ | 59/72 [01:35<00:21,  1.67s/it] 83%|████████▎ | 60/72 [01:37<00:23,  1.92s/it] 85%|████████▍ | 61/72 [01:38<00:17,  1.55s/it] 86%|████████▌ | 62/72 [01:39<00:16,  1.61s/it] 88%|████████▊ | 63/72 [01:42<00:16,  1.87s/it] 89%|████████▉ | 64/72 [01:42<00:10,  1.34s/it] 90%|█████████ | 65/72 [01:44<00:11,  1.63s/it] 92%|█████████▏| 66/72 [01:47<00:11,  1.88s/it] 93%|█████████▎| 67/72 [01:47<00:06,  1.35s/it] 94%|█████████▍| 68/72 [01:49<00:06,  1.66s/it] 96%|█████████▌| 69/72 [01:52<00:05,  1.89s/it] 97%|█████████▋| 70/72 [01:52<00:02,  1.36s/it] 99%|█████████▊| 71/72 [01:54<00:01,  1.67s/it]100%|██████████| 72/72 [01:57<00:00,  1.92s/it]100%|██████████| 72/72 [01:57<00:00,  1.63s/it]
Successfully Getting Q Lists!
Successfully Getting Q Lists!
Successfully Getting Q Lists!
Finish Getting Q list
Successfully Getting Q Lists!
Start Calculating Lambda!
  0%|          | 0/9 [00:00<?, ?it/s]  0%|          | 0/9 [00:00<?, ?it/s]  0%|          | 0/9 [00:00<?, ?it/s]  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:02<00:23,  2.99s/it] 11%|█         | 1/9 [00:02<00:23,  2.99s/it] 11%|█         | 1/9 [00:03<00:30,  3.87s/it] 11%|█         | 1/9 [00:04<00:33,  4.17s/it] 22%|██▏       | 2/9 [00:05<00:17,  2.57s/it] 22%|██▏       | 2/9 [00:05<00:18,  2.61s/it] 22%|██▏       | 2/9 [00:07<00:25,  3.67s/it] 22%|██▏       | 2/9 [00:07<00:26,  3.72s/it] 33%|███▎      | 3/9 [00:07<00:15,  2.59s/it] 33%|███▎      | 3/9 [00:07<00:15,  2.59s/it] 33%|███▎      | 3/9 [00:10<00:19,  3.22s/it] 44%|████▍     | 4/9 [00:10<00:13,  2.64s/it] 44%|████▍     | 4/9 [00:10<00:13,  2.74s/it] 33%|███▎      | 3/9 [00:10<00:20,  3.40s/it] 56%|█████▌    | 5/9 [00:13<00:10,  2.64s/it] 56%|█████▌    | 5/9 [00:13<00:10,  2.72s/it] 44%|████▍     | 4/9 [00:13<00:16,  3.23s/it] 44%|████▍     | 4/9 [00:13<00:16,  3.27s/it] 67%|██████▋   | 6/9 [00:15<00:07,  2.54s/it] 67%|██████▋   | 6/9 [00:16<00:07,  2.64s/it] 56%|█████▌    | 5/9 [00:16<00:13,  3.27s/it] 56%|█████▌    | 5/9 [00:16<00:13,  3.29s/it] 78%|███████▊  | 7/9 [00:18<00:05,  2.52s/it] 78%|███████▊  | 7/9 [00:18<00:05,  2.60s/it] 67%|██████▋   | 6/9 [00:20<00:09,  3.26s/it] 67%|██████▋   | 6/9 [00:19<00:09,  3.22s/it] 89%|████████▉ | 8/9 [00:20<00:02,  2.46s/it] 89%|████████▉ | 8/9 [00:21<00:02,  2.67s/it]100%|██████████| 9/9 [00:23<00:00,  2.67s/it]100%|██████████| 9/9 [00:23<00:00,  2.61s/it]
 78%|███████▊  | 7/9 [00:23<00:06,  3.27s/it] 78%|███████▊  | 7/9 [00:23<00:06,  3.42s/it]100%|██████████| 9/9 [00:24<00:00,  2.78s/it]100%|██████████| 9/9 [00:24<00:00,  2.71s/it]
 89%|████████▉ | 8/9 [00:26<00:03,  3.10s/it] 89%|████████▉ | 8/9 [00:26<00:03,  3.13s/it]100%|██████████| 9/9 [00:28<00:00,  2.83s/it]100%|██████████| 9/9 [00:28<00:00,  3.17s/it]
100%|██████████| 9/9 [00:28<00:00,  3.03s/it]100%|██████████| 9/9 [00:28<00:00,  3.21s/it]
Finish Getting Lambda list
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:02<00:19,  2.17s/it] 10%|█         | 1/10 [00:02<00:24,  2.71s/it] 10%|█         | 1/10 [00:02<00:26,  2.96s/it] 10%|█         | 1/10 [00:02<00:26,  2.92s/it] 20%|██        | 2/10 [00:04<00:16,  2.03s/it] 20%|██        | 2/10 [00:04<00:17,  2.22s/it] 20%|██        | 2/10 [00:06<00:25,  3.13s/it] 20%|██        | 2/10 [00:06<00:26,  3.25s/it] 30%|███       | 3/10 [00:06<00:15,  2.21s/it] 30%|███       | 3/10 [00:07<00:17,  2.55s/it] 30%|███       | 3/10 [00:08<00:18,  2.65s/it] 40%|████      | 4/10 [00:08<00:13,  2.23s/it] 30%|███       | 3/10 [00:08<00:20,  2.89s/it] 40%|████      | 4/10 [00:09<00:13,  2.26s/it] 40%|████      | 4/10 [00:10<00:14,  2.42s/it] 50%|█████     | 5/10 [00:10<00:10,  2.09s/it] 40%|████      | 4/10 [00:10<00:15,  2.54s/it] 50%|█████     | 5/10 [00:10<00:09,  2.00s/it] 50%|█████     | 5/10 [00:12<00:11,  2.33s/it] 60%|██████    | 6/10 [00:12<00:08,  2.04s/it] 60%|██████    | 6/10 [00:13<00:08,  2.16s/it] 50%|█████     | 5/10 [00:13<00:12,  2.53s/it] 70%|███████   | 7/10 [00:14<00:06,  2.07s/it] 60%|██████    | 6/10 [00:14<00:09,  2.35s/it] 70%|███████   | 7/10 [00:15<00:06,  2.04s/it] 60%|██████    | 6/10 [00:15<00:09,  2.45s/it] 80%|████████  | 8/10 [00:16<00:04,  2.06s/it] 70%|███████   | 7/10 [00:17<00:06,  2.33s/it] 80%|████████  | 8/10 [00:17<00:04,  2.11s/it] 70%|███████   | 7/10 [00:17<00:06,  2.33s/it] 90%|█████████ | 9/10 [00:18<00:01,  1.85s/it] 80%|████████  | 8/10 [00:19<00:04,  2.17s/it] 90%|█████████ | 9/10 [00:19<00:02,  2.12s/it] 80%|████████  | 8/10 [00:19<00:04,  2.29s/it]100%|██████████| 10/10 [00:19<00:00,  1.83s/it]100%|██████████| 10/10 [00:19<00:00,  1.99s/it]
100%|██████████| 10/10 [00:21<00:00,  2.02s/it]100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
 90%|█████████ | 9/10 [00:21<00:02,  2.23s/it] 90%|█████████ | 9/10 [00:21<00:02,  2.17s/it]100%|██████████| 10/10 [00:22<00:00,  1.86s/it]100%|██████████| 10/10 [00:22<00:00,  2.24s/it]
100%|██████████| 10/10 [00:23<00:00,  1.94s/it]100%|██████████| 10/10 [00:23<00:00,  2.33s/it]
  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.62s/it] 25%|██▌       | 1/4 [00:02<00:07,  2.60s/it] 25%|██▌       | 1/4 [00:02<00:08,  2.79s/it] 25%|██▌       | 1/4 [00:02<00:08,  2.77s/it] 50%|█████     | 2/4 [00:02<00:02,  1.45s/it] 50%|█████     | 2/4 [00:04<00:03,  2.00s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.62s/it] 50%|█████     | 2/4 [00:05<00:05,  2.78s/it] 50%|█████     | 2/4 [00:05<00:05,  2.80s/it]100%|██████████| 4/4 [00:06<00:00,  1.86s/it]100%|██████████| 4/4 [00:06<00:00,  1.75s/it]
 75%|███████▌  | 3/4 [00:07<00:02,  2.51s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.80s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.78s/it]100%|██████████| 4/4 [00:08<00:00,  2.05s/it]100%|██████████| 4/4 [00:08<00:00,  2.16s/it]
100%|██████████| 4/4 [00:09<00:00,  2.31s/it]100%|██████████| 4/4 [00:09<00:00,  2.48s/it]
100%|██████████| 4/4 [00:09<00:00,  2.29s/it]100%|██████████| 4/4 [00:09<00:00,  2.47s/it]
  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.21s/it] 25%|██▌       | 1/4 [00:02<00:06,  2.33s/it] 25%|██▌       | 1/4 [00:02<00:08,  2.85s/it] 25%|██▌       | 1/4 [00:02<00:08,  2.84s/it] 50%|█████     | 2/4 [00:04<00:04,  2.22s/it] 50%|█████     | 2/4 [00:04<00:04,  2.35s/it] 50%|█████     | 2/4 [00:04<00:04,  2.37s/it] 50%|█████     | 2/4 [00:05<00:04,  2.47s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.05s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.20s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.13s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.14s/it]100%|██████████| 4/4 [00:07<00:00,  1.74s/it]100%|██████████| 4/4 [00:07<00:00,  1.90s/it]
100%|██████████| 4/4 [00:08<00:00,  1.98s/it]100%|██████████| 4/4 [00:08<00:00,  2.08s/it]
100%|██████████| 4/4 [00:08<00:00,  1.93s/it]100%|██████████| 4/4 [00:08<00:00,  2.10s/it]
100%|██████████| 4/4 [00:08<00:00,  1.94s/it]100%|██████████| 4/4 [00:08<00:00,  2.10s/it]
  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.34s/it] 25%|██▌       | 1/4 [00:02<00:07,  2.48s/it] 25%|██▌       | 1/4 [00:02<00:08,  2.93s/it] 25%|██▌       | 1/4 [00:02<00:08,  2.93s/it] 50%|█████     | 2/4 [00:04<00:04,  2.40s/it] 50%|█████     | 2/4 [00:04<00:04,  2.38s/it] 50%|█████     | 2/4 [00:05<00:04,  2.44s/it] 50%|█████     | 2/4 [00:05<00:04,  2.47s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.49s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.49s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.47s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.59s/it]100%|██████████| 4/4 [00:09<00:00,  2.21s/it]100%|██████████| 4/4 [00:09<00:00,  2.29s/it]
100%|██████████| 4/4 [00:09<00:00,  2.14s/it]100%|██████████| 4/4 [00:09<00:00,  2.29s/it]
100%|██████████| 4/4 [00:09<00:00,  2.10s/it]100%|██████████| 4/4 [00:09<00:00,  2.29s/it]
100%|██████████| 4/4 [00:09<00:00,  2.20s/it]100%|██████████| 4/4 [00:09<00:00,  2.29s/it]
['./influence_outputs/Qwen2.5-0.5B-Instruct-mix_200/val_avg_grad.pt', './influence_outputs/Qwen2.5-0.5B-Instruct-mix_200/val_science_grad.pt', './influence_outputs/Qwen2.5-0.5B-Instruct-mix_200/val_math_grad.pt', './influence_outputs/Qwen2.5-0.5B-Instruct-mix_200/val_code_grad.pt']
  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.80s/it] 25%|██▌       | 1/4 [00:03<00:09,  3.11s/it] 25%|██▌       | 1/4 [00:03<00:09,  3.12s/it] 25%|██▌       | 1/4 [00:03<00:09,  3.22s/it] 50%|█████     | 2/4 [00:04<00:04,  2.16s/it] 50%|█████     | 2/4 [00:05<00:04,  2.48s/it] 50%|█████     | 2/4 [00:05<00:05,  2.67s/it] 50%|█████     | 2/4 [00:05<00:05,  2.67s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.13s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.27s/it]100%|██████████| 4/4 [00:07<00:00,  1.77s/it]100%|██████████| 4/4 [00:07<00:00,  1.96s/it]
 75%|███████▌  | 3/4 [00:07<00:02,  2.60s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.60s/it]100%|██████████| 4/4 [00:08<00:00,  1.91s/it]100%|██████████| 4/4 [00:08<00:00,  2.13s/it]
100%|██████████| 4/4 [00:09<00:00,  2.15s/it]100%|██████████| 4/4 [00:09<00:00,  2.36s/it]
100%|██████████| 4/4 [00:09<00:00,  2.16s/it]100%|██████████| 4/4 [00:09<00:00,  2.38s/it]
  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.84s/it] 25%|██▌       | 1/4 [00:02<00:08,  2.86s/it] 25%|██▌       | 1/4 [00:02<00:08,  3.00s/it] 25%|██▌       | 1/4 [00:03<00:09,  3.19s/it] 50%|█████     | 2/4 [00:04<00:04,  2.19s/it] 50%|█████     | 2/4 [00:04<00:04,  2.36s/it] 50%|█████     | 2/4 [00:04<00:04,  2.40s/it] 50%|█████     | 2/4 [00:04<00:04,  2.37s/it] 75%|███████▌  | 3/4 [00:06<00:01,  1.93s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.26s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.33s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.28s/it]100%|██████████| 4/4 [00:07<00:00,  1.66s/it]100%|██████████| 4/4 [00:07<00:00,  1.86s/it]
100%|██████████| 4/4 [00:08<00:00,  1.87s/it]100%|██████████| 4/4 [00:08<00:00,  2.09s/it]
100%|██████████| 4/4 [00:08<00:00,  1.99s/it]100%|██████████| 4/4 [00:08<00:00,  2.18s/it]
100%|██████████| 4/4 [00:08<00:00,  2.03s/it]100%|██████████| 4/4 [00:08<00:00,  2.18s/it]
  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.50s/it] 25%|██▌       | 1/4 [00:03<00:09,  3.10s/it] 25%|██▌       | 1/4 [00:03<00:09,  3.11s/it] 25%|██▌       | 1/4 [00:03<00:09,  3.25s/it] 50%|█████     | 2/4 [00:03<00:03,  1.89s/it] 50%|█████     | 2/4 [00:04<00:04,  2.23s/it] 50%|█████     | 2/4 [00:04<00:04,  2.25s/it] 50%|█████     | 2/4 [00:04<00:04,  2.28s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.83s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.04s/it]100%|██████████| 4/4 [00:06<00:00,  1.45s/it]100%|██████████| 4/4 [00:06<00:00,  1.65s/it]
 75%|███████▌  | 3/4 [00:06<00:02,  2.08s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.05s/it]100%|██████████| 4/4 [00:07<00:00,  1.73s/it]100%|██████████| 4/4 [00:07<00:00,  1.95s/it]
100%|██████████| 4/4 [00:08<00:00,  1.90s/it]100%|██████████| 4/4 [00:08<00:00,  2.06s/it]
100%|██████████| 4/4 [00:08<00:00,  1.89s/it]100%|██████████| 4/4 [00:08<00:00,  2.07s/it]
['./influence_outputs/Qwen2.5-0.5B-Instruct-mix_200/train_code_grad.pt', './influence_outputs/Qwen2.5-0.5B-Instruct-mix_200/train_math_grad.pt', './influence_outputs/Qwen2.5-0.5B-Instruct-mix_200/train_science_grad.pt']
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
Finish Loading Lambda list
Finish Loading Train Grad list
Finish Loading Validation Grad list
--------------------
Start Calculating Influence
[[0.00191498 0.0006485  0.00071716]
 [0.00049973 0.00047302 0.00068283]
 [0.00041199 0.00057602 0.00035286]
 [0.0035553  0.00039673 0.00040627]]
[W606 02:15:48.881445287 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
/home/xiexin/xx_help/LLaMA-Factory/ScriptExecution/run_influence_analysis.sh: 行 78: 寻找匹配的 `"' 时遇到了未预期的 EOF
